<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="app.js"></script>
    <style>
        /* CSS 스타일링 (선택 사항) */
        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 2px;
        }
    </style>
</head>
<body>
    <h1>SVG BAR</h1>
    <svg>
        <rect width="50" height="200" style="fill: blue">
    </svg>

    <svg width="100" height="100">
        <circle cx="50" cy="50" r="25" style="fill: blue">
    </svg>

    <h1>D3 JS</h1>
    <p></p>
    <script>
        // var w = 500;
        // var h  = 100;
        // var padding = 2;
        // var dataset = [5, 10, 15, 20, 25];
        // var svg = d3.select("body")
        //             .append("svg")
        //             .attr("width", w)
        //             .attr("height", h)
        //             .style('fill', "gray")

        // svg.selectAll("rect")
        //     .data(dataset)
        //     .enter()
        //     .append("rect")
        //         .attr("x", function(d, i){ return (i * 25)})
        //         .attr("y", function (d){
        //             console.log(h - d)
        //             return h - (d * 3)})
        //         .attr("width", 20)
        //         .attr("height", function(d){ return d * 3 })

        // BAR CHART
        // var w = 300;
        // var h = 500;
        // var padding = 2;
        // var dataset = [5, 10, 14, 20, 25, 11, 25, 22, 18, 7];
        // var svg = d3.select("body")
        //             .append("svg")
        //             .attr("width", w)
        //             .attr("height", h);


        // function colorPicker(v){
        //     if( v <= 20 ){ return "#66666" };
        //     if( v > 20 ){ return "#FF0033" };
        // };


        // svg.selectAll("rect")
        //     .data(dataset)
        //     .enter()
        //     .append("rect")
        //         .attr("x", function(d, i){ return i * (w / dataset.length); })
        //         .attr("y", function(d){ return h - (d * 4); })
        //         .attr("width", w / dataset.length - padding)
        //         .attr("height", function(d){ return d * 4 })
        //         .attr("fill", function(d){ return colorPicker(d) });

        // svg.selectAll("text")
        //     .data(dataset)
        //     .enter()
        //     .append("text")
        //     .text(function(d){ return d })
        //     .attr({
        //         "text-anchor" : "middle",
        //         "font-famliy" : "sans-serif",
        //         "fill" : "#ffffff",
        //         "font-size" : "12",
        //         x : function(d, i){ return i * ( w / dataset.length) + 15},
        //         y : function( d ){ return h - (d*3) + 10},

        //     });



        //LINE CHART 

        // var h = 300;
        // var w = 500;

        // monthlySales = [
        //     {"month": 10, "sales": 200},
        //     {"month": 20, "sales": 150},
        //     {"month": 30, "sales": 140},
        //     {"month": 40, "sales": 200},
        //     {"month": 50, "sales": 210},
        //     {"month": 60, "sales": 150},
        //     {"month": 70, "sales": 220},
        //     {"month": 80, "sales": 90},
        //     {"month": 90, "sales": 240},
        //     {"month": 100, "sales": 170},
        // ];
        

        // //actually draws a line graph
        // var lineFun = d3.svg.line()
        //     .x(function(d, i){ 
        //         return d.month*3 })
        //     .y(function(d){ return h - d.sales; })
        //     .interpolate("linear");
        
        // //a size of scope that wrap the line graph 
        // var svg = d3.select("body")
        //             .append("svg")
        //             .attr({width: w, height: h});

        // var viz = svg.append("path")
        //             .attr({d: lineFun(monthlySales),
        //                     "stroke" : "purple",
        //                     "stroke-width" : 2, //여기선 라인그래프 두꼐 또는 도형을 그릴떄는 외곽선 고정 , svg영역안에 있는 도형의 크기가 변경되면 stroke-width를 지정하지 않을경우  padding이 안에있는 도형크기데 따라 변경되는것을 방지  
        //                     "fill" : "none"
        //             });

        // var lables = svg.selectAll("text")
        //                 .data(monthlySales)
        //                 .enter()
        //                 .append("text")
        //                 .text(function(d){ return d.sales })
        //                 .attr({
        //                     x: function(d){ return d.month * 5 + 5 },
        //                     y: function(d) { return h - d.sales },
        //                     "font-size" : "12px",
        //                     "font-familt" : "sans-serif",
        //                     "fill" : "#666666",
        //                     "text-anchor" : "start",
        //                     "dy" : ".85em",
        //                     "font-weigth" : function(d, i) { 
        //                         if( i === 0 || i === (monthlySales.length-1)){
        //                             return "bold"
        //                         } else {
        //                             return "normal"
        //                         } 
        //                     }
        //                 })



        //scatter plot 

        // var h = 300;
        // var w = 500;

        // monthlySales = [
        //     {"month": 10, "sales": 200},
        //     {"month": 20, "sales": 150},
        //     {"month": 30, "sales": 140},
        //     {"month": 40, "sales": 200},
        //     {"month": 50, "sales": 210},
        //     {"month": 60, "sales": 150},
        //     {"month": 70, "sales": 220},
        //     {"month": 80, "sales": 90},
        //     {"month": 90, "sales": 240},
        //     {"month": 100, "sales": 170},
        // ];

        // function salesKPI(d) {
        //     if( d>=240 ){
        //         return "#33CC66"
        //     }else if ( d<100 ){
        //         return "#666666"
        //     }
        // };
        // function showMinMax(ds, col, val, type) {
        //     var max = d3.max(ds, function(d){ return d[col] });
        //     console.log(max)
        //     var min = d3.min(ds, function(d){ return d[col] });
        //     console.log(min)
        //     if (type === 'minmax' && (val == max || val == min)){
        //         return val
        //     }else if(type === "all") {
        //         return val
        //     }
        // }
        // var  svg = d3.select("body")
        //             .append("svg")
        //             .attr({width: w, height: h});

        // var dots = svg.selectAll("circle")
        //             .data(monthlySales)
        //             .enter()
        //             .append("circle")
        //             .attr({
        //                 cx: function(d){ return d.month*3 },
        //                 cy: function(d){ return h-d.sales },
        //                 r: 5,
        //                 "fill" : function(d) { return salesKPI(d.sales) }
        //             })

        // var labels = svg.selectAll("text")
        //                 .data(monthlySales)
        //                 .enter()
        //                 .append("text")
        //                 .text( function(d){ return showMinMax(monthlySales, "sales", d.sales, "minmax"); })
        //                 .attr({
        //                     x: function(d){ return (d.month*3) - 28 },
        //                     y: function(d){ return h-d.sales },
        //                     "font-size" : "12px",
        //                     "font-family" : "sans-serif",
        //                     "fill" : "#666666",
        //                     "text-anchor" : "start",
        //                 });
        

        
    //JSON 

    var dataset = [
            {"Month": "January", "Sales": 3400},
            {"Month": "February", "Sales": 2800},
            {"Month": "March", "Sales": 3900},
            {"Month": "April", "Sales": 4200},
            {"Month": "May", "Sales": 3500},
            {"Month": "June", "Sales": 5000},
            {"Month": "July", "Sales": 4800},
            {"Month": "August", "Sales": 3800},
            {"Month": "September", "Sales": 4100},
            {"Month": "October", "Sales": 3700}
        ];

        // SVG 요소 크기 설정
        var svgWidth = 800;
        var svgHeight = 400;

        // SVG 요소 생성
        var svg = d3.select("body")
                    .append("svg")
                    .attr("width", svgWidth)
                    .attr("height", svgHeight);

        // x 축 스케일
        var xScale = d3.scaleBand()
                       .domain(dataset.map(d => d.Month))
                       .range([0, svgWidth])
                       .padding(0.1);

        // y 축 스케일
        var yScale = d3.scaleLinear()
                       .domain([0, d3.max(dataset, d => d.Sales)]) 
                       .nice()
                       .range([svgHeight, 0]);

        // 선 생성기
        var line = d3.line()
                     .x(d => xScale(d.Month) + xScale.bandwidth() / 2) 
                     .y(d => yScale(d.Sales));

        // 선 그리기
        svg.append("path")
           .datum(dataset)
           .attr("class", "line")
           .attr("d", line);

        // x 축 생성
        svg.append("g")
           .attr("transform", "translate(0," + svgHeight + ")")
           .call(d3.axisBottom(xScale));

        // y 축 생성
        svg.append("g")
           .call(d3.axisLeft(yScale));

    </script>
    
</body>
</html>